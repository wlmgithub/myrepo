#!/usr/bin/perl -w
use strict;

### globals
my $DATA_DIR="/Library/WebServer/Documents/dashboard/data/total_count";

my $glulist = "/usr/local/foobar/bin/glulist";
my $push_auditor = "/usr/local/foobar/bin/push_auditor";


print "generating total service count ...\n";
my @all_services = get_all_services_in_ela4();
my $total_count = @all_services ;

my $fname = "$DATA_DIR/count.txt";

open my $fh, ">$fname" or die "cannot write to file: $fname: $!\n";
print $fh $total_count;
close $fh;
chmod 0777, $fname;

### subs

sub get_all_services_in_ela4 {

  chomp( my @s = `$glulist  -f prod-ela4` );

  return @s if wantarray;

}
